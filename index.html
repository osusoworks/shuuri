<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>修理料金案内アシスト</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif; line-height: 1.6; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; padding: 20px; }
        .header { background: #2c3e50; color: white; padding: 20px; text-align: center; border-radius: 10px; margin-bottom: 30px; }
        .step-counter { font-size: 18px; margin-bottom: 10px; color: #7f8c8d; }
        .card { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .question { font-size: 20px; margin-bottom: 25px; color: #2c3e50; font-weight: bold; }
        .options { display: grid; gap: 15px; }
        .option-btn { padding: 15px 20px; border: 2px solid #3498db; background: white; color: #3498db; border-radius: 8px; cursor: pointer; transition: all 0.3s; font-size: 16px; text-align: left; }
        .option-btn:hover { background: #3498db; color: white; }
        .option-btn.selected { background: #3498db; color: white; }
        .checkbox-group { display: grid; gap: 12px; margin: 20px 0; }
        .checkbox-item { display: flex; align-items: center; padding: 12px; border: 2px solid #ecf0f1; border-radius: 8px; }
        .checkbox-item input[type="checkbox"] { margin-right: 12px; transform: scale(1.2); }
        .navigation { display: flex; gap: 15px; margin-top: 30px; }
        .nav-btn { padding: 12px 25px; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; transition: all 0.3s; }
        .btn-back { background: #95a5a6; color: white; }
        .btn-next { background: #27ae60; color: white; flex: 1; }
        .btn-reset { background: #e74c3c; color: white; }
        .result { background: #ecf0f1; padding: 25px; border-radius: 10px; margin: 20px 0; }
        .price-display { font-size: 24px; color: #2c3e50; font-weight: bold; margin: 15px 0; }
        .note { color: #7f8c8d; font-size: 14px; margin-top: 15px; }
        .polish-note { font-size: 12px; color: #555; margin-top: 10px; }
        .hidden { display: none; }
        @media (max-width: 768px) { .container { padding: 10px; } .card { padding: 20px; } .option-btn { font-size: 14px; padding: 12px 15px; } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>修理料金案内アシスト</h1>
        </div>

        <div id="step-container" class="card">
            <div class="step-counter" id="step-counter">ステップ 1/5</div>
            <div class="question" id="question">大分類を選択してください</div>
            <div class="options" id="options"></div>
            <div class="navigation">
                <button class="nav-btn btn-back hidden" id="back-btn" onclick="goBack()">戻る</button>
                <button class="nav-btn btn-next" id="next-btn" onclick="goNext()">次へ</button>
                <button class="nav-btn btn-reset" onclick="resetApp()">リセット</button>
            </div>
        </div>

        <div id="result-container" class="card hidden">
            <h2>修理料金計算結果</h2>
            <div id="result-content"></div>
            <div class="navigation">
                <button class="nav-btn btn-reset" onclick="resetApp()">新規計算</button>
            </div>
        </div>
    </div>

    <script>
        const priceData = {
            "国産時計": {
                "SEIKO（一般）": { quartz3: 11000, quartzChrono: 15400, mechanical3: 15400, mechanicalChrono: 17600 },
                "SEIKO（DOLCE系）": { quartz3: 11000, quartzChrono: 15400, mechanical3: 15400, mechanicalChrono: 17600 },
                "SEIKO（GS・CREDOR）": { quartz3: 33000, quartzChrono: 38500, mechanical3: 44000, mechanicalChrono: 48400 },
                "CITIZEN": { quartz3: 11000, quartzChrono: 15400, mechanical3: 15400, mechanicalChrono: 17600 },
                "CASIO": { quartz3: 11000, quartzChrono: 15400, mechanical3: 15400, mechanicalChrono: 17600 },
                "ORIENT": { quartz3: 11000, quartzChrono: 15400, mechanical3: 15400, mechanicalChrono: 17600 },
                "その他国産": { quartz3: 11000, quartzChrono: 15400, mechanical3: 15400, mechanicalChrono: 17600 }
            },
            "舶来時計": {
                "グループA（CYMA、ETERNA、ENICAR、FENDI、NINARICCI等）": { quartz3: 27500, quartzChrono: 33000, mechanical3: 36300, mechanicalChrono: 44000 },
                "グループB（DIOR、DUNHILL、GUCCI、HAMILTON、HUNTING WORLD、LONGINES等）": { quartz3: 30800, quartzChrono: 38500, mechanical3: 49500, mechanicalChrono: 55000 },
                "グループC（CHANEL、EBEL、HERMES、JUVENIA等）": { quartz3: 33000, quartzChrono: 38500, mechanical3: 55000, mechanicalChrono: 66000 },
                "グループD（BREITLING、BAUME & MERCIER、CARTIER、CORUM、FRANK MULLER等）": { quartz3: 38500, quartzChrono: 44000, mechanical3: 66000, mechanicalChrono: 77000 },
                "グループE（AUDEMARS PIGUET、CHOPARD、PATEK PHILIPPE等）": { quartz3: 66000, quartzChrono: 77000, mechanical3: 110000, mechanicalChrono: 132000 }
            },
            "OMEGA・TAG HEUER": {
                "OMEGA": { quartz3: 33000, quartzChrono: 38500, mechanical3: 49500, mechanicalChrono: 55000 },
                "TAG HEUER": { quartz3: 38500, quartzChrono: 44000, mechanical3: 66000, mechanicalChrono: 77000 }
            },
            "ROLEX": {
                "ROLEX": { quartz3: 49500, quartzChrono: 55000, mechanical3: 77000, mechanicalChrono: 88000 }
            }
        };

        let currentStep = 1;
        let selections = {};

        const steps = [
            {
                question: "大分類を選択してください",
                options: ["国産時計", "舶来時計", "OMEGA・TAG HEUER", "ROLEX"],
                key: "category"
            },
            {
                question: "ブランド・価格帯を選択してください",
                getOptions: () => {
                    const category = selections.category;
                    return Object.keys(priceData[category] || {});
                },
                key: "brand"
            },
            {
                question: "機構を選択してください",
                options: ["クォーツ 3針", "クォーツ クロノグラフ", "メカニカル 3針", "メカニカル クロノグラフ"],
                key: "mechanism"
            },
            {
                question: "特殊仕様を選択してください（該当するものにチェック）",
                type: "checkbox",
                options: [
                    { label: "シースルーバック（+2,200円）", value: "seethrough", price: 2200 },
                    { label: "OMEGA コーアクシャル（+11,000円）", value: "coaxial", price: 11000, condition: () => selections.brand === "OMEGA" }
                ],
                key: "special"
            },
            {
                question: "磨きオプションを選択してください（該当するものにチェック）",
                type: "checkbox",
                options: [
                    { label: "ライトポリッシュ（3連：6,600円）", value: "light3", price: 6600 },
                    { label: "ライトポリッシュ（5連：8,800円）", value: "light5", price: 8800 },
                    { label: "新品仕上げ（3連：11,000円）", value: "finish3", price: 11000 },
                    { label: "新品仕上げ（5連：13,200円）", value: "finish5", price: 13200 }
                ],
                key: "polish"
            }
        ];

        function shouldShowPolish() {
            return selections.category === "ROLEX" || (selections.category === "OMEGA・TAG HEUER" && selections.brand === "OMEGA");
        }

        function renderStep() {
            const step = steps[currentStep - 1];
            
            // ステップ5で磨きオプションが不要な場合は結果表示へ
            if (currentStep === 5 && !shouldShowPolish()) {
                selections.polish = []; // 磨きオプションなし
                showResult();
                return;
            }
            
            document.getElementById('step-counter').textContent = `ステップ ${currentStep}/5`;
            document.getElementById('question').textContent = step.question;
            
            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';

            if (step.type === 'checkbox') {
                step.options.forEach(option => {
                    if (option.condition && !option.condition()) return;
                    
                    const div = document.createElement('div');
                    div.className = 'checkbox-item';
                    div.innerHTML = `
                        <input type="checkbox" id="${option.value}" value="${option.value}">
                        <label for="${option.value}">${option.label}</label>
                    `;
                    optionsContainer.appendChild(div);
                });
            } else {
                const options = step.getOptions ? step.getOptions() : step.options;
                options.forEach(option => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.textContent = option;
                    btn.onclick = () => selectOption(option);
                    if (selections[step.key] === option) {
                        btn.classList.add('selected');
                    }
                    optionsContainer.appendChild(btn);
                });
            }

            document.getElementById('back-btn').classList.toggle('hidden', currentStep === 1);
            
            // 最終ステップでは「計算結果を表示」ボタンに変更
            const nextBtn = document.getElementById('next-btn');
            if (currentStep === 5) {
                nextBtn.textContent = '計算結果を表示';
            } else {
                nextBtn.textContent = '次へ';
            }
        }

        function selectOption(option) {
            const step = steps[currentStep - 1];
            selections[step.key] = option;
            renderStep();
        }

        function goNext() {
            const step = steps[currentStep - 1];
            
            if (step.type === 'checkbox') {
                const checkboxes = document.querySelectorAll('#options input[type="checkbox"]');
                selections[step.key] = Array.from(checkboxes)
                    .filter(cb => cb.checked)
                    .map(cb => cb.value);
            }

            if (currentStep === 5) {
                showResult();
            } else if (currentStep === 4 && !shouldShowPolish()) {
                // 磨きオプションがない場合は結果表示へ
                selections.polish = [];
                showResult();
            } else if (selections[step.key] !== undefined) {
                currentStep++;
                renderStep();
            } else {
                alert('選択肢を選んでください');
            }
        }

        function goBack() {
            if (currentStep > 1) {
                currentStep--;
                renderStep();
            }
        }

        function showResult() {
            const category = selections.category;
            const brand = selections.brand;
            const mechanism = selections.mechanism;
            
            let mechanismKey;
            switch(mechanism) {
                case "クォーツ 3針": mechanismKey = "quartz3"; break;
                case "クォーツ クロノグラフ": mechanismKey = "quartzChrono"; break;
                case "メカニカル 3針": mechanismKey = "mechanical3"; break;
                case "メカニカル クロノグラフ": mechanismKey = "mechanicalChrono"; break;
            }

            const basePrice = priceData[category][brand][mechanismKey];
            let additionalPrice = 0;
            let polishPrice = 0;
            let additionalItems = [];

            // 特殊仕様の加算
            if (selections.special && selections.special.length > 0) {
                steps[3].options.forEach(option => {
                    if (selections.special.includes(option.value)) {
                        additionalPrice += option.price;
                        additionalItems.push(option.label);
                    }
                });
            }

            // 磨きオプションの加算
            if (selections.polish && selections.polish.length > 0) {
                steps[4].options.forEach(option => {
                    if (selections.polish.includes(option.value)) {
                        polishPrice += option.price;
                        additionalItems.push(option.label);
                    }
                });
            }

            const totalPrice = basePrice + additionalPrice + polishPrice;

            // 保証期間の判定
            let warranty = "1年";
            if (category === "国産時計" && (brand === "SEIKO（GS・CREDOR）")) {
                warranty = "2年";
            } else if (category === "舶来時計" || category === "OMEGA・TAG HEUER" || category === "ROLEX") {
                if (mechanismKey.includes("mechanical")) {
                    warranty = "2年";
                }
            }

            let resultHTML = `
                <div class="result">
                    <h3>選択内容</h3>
                    <p><strong>分類：</strong>${category}</p>
                    <p><strong>ブランド：</strong>${brand}</p>
                    <p><strong>機構：</strong>${mechanism}</p>
                    
                    <h3>料金詳細</h3>
                    <p><strong>基本料金：</strong>¥${basePrice.toLocaleString()}〜</p>
            `;

            if (additionalItems.length > 0) {
                resultHTML += `<p><strong>追加料金：</strong></p><ul>`;
                additionalItems.forEach(item => {
                    resultHTML += `<li>${item}</li>`;
                });
                resultHTML += `</ul>`;
            }

            resultHTML += `
                    <div class="price-display">
                        <strong>合計金額：¥${totalPrice.toLocaleString()}〜</strong>
                    </div>
            `;

            // 磨きセット価格表示
            if (shouldShowPolish()) {
                resultHTML += `
                    <div class="polish-note">
                        <p>参考：磨きセット価格（修理料金＋磨き）＝¥${totalPrice.toLocaleString()}〜</p>
                        ${polishPrice > 0 ? '<p>※磨きの対応可否や詳細は修理業者判断の場合があります。</p>' : ''}
                    </div>
                `;
            }

            resultHTML += `
                    <p><strong>保証期間：</strong>${warranty}</p>
                    
                    <div class="note">
                        ${category === "ROLEX" ? "※ROLEX磨きは別料金（要相談）" : ""}
                    </div>
                </div>
            `;

            document.getElementById('result-content').innerHTML = resultHTML;
            document.getElementById('step-container').classList.add('hidden');
            document.getElementById('result-container').classList.remove('hidden');
        }

        function resetApp() {
            currentStep = 1;
            selections = {};
            document.getElementById('step-container').classList.remove('hidden');
            document.getElementById('result-container').classList.add('hidden');
            renderStep();
        }

        // 初期化
        renderStep();
    </script>
</body>
</html>
